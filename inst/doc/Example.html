<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>MALDI cell based assay Example</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">MALDI cell based assay Example</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In this document we will apply an automated screening for possible
candidate signals that show a response to treatment with a compound. For
details how to do the experimental part check out our Nature Protocols
publication Unger 2021 “Label-free Cell Assays of Compound Uptake and
Drug Action using MALDI-TOF Mass Spectrometry”. Briefly, cells were
treated with the following concentration of a compound: 0, 0.04, 0.12,
0.37, 1.11, 3.33, 10, 30 uM. After incubation the cells were washed,
transferred to a MALDI target plate and matrix was applied. For each
concentration 4 spots were applied which means that we also have 4
“measurement replicates” for each concentration.</p>
<p>The most important function in this package is fitCurve(). It does
not only fit the dose response curve and compute score values but it
also does most of the necessary steps needed to prepare the data for
fitting like normalization and alignment. In this tutorial we want to
first look at each of this steps individually and then apply the
fitCurve() function the helps us combine all of them.</p>
<p>For the sake to keep this package small, the spectra used as an
example here were trimmed to 400-900 Da mass-range and stored in a
compact form as example data.</p>
</div>
<div id="example-data-and-quality-check" class="section level2">
<h2>Example data and quality check</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(MALDIcellassay)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(MALDIquant)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; This is MALDIquant version 1.22.1</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; Quantitative Analysis of Mass Spectrometry Data</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt;  See &#39;?MALDIquant&#39; for more information about this package.</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Blank2022spec&quot;</span>)</span></code></pre></div>
<p>First we will check the spectra for general quality.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>MALDIquant<span class="sc">::</span><span class="fu">plot</span>(Blank2022spec[[<span class="dv">1</span>]], <span class="at">main =</span> <span class="st">&quot;0uM, replicate 1&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="preprocessing" class="section level2">
<h2>Preprocessing</h2>
<p>The baseline of the spectra already looks ok but for the sake of this
tutorial we will apply a baseline correction. But first we want so save
the names of the spectra (which are the concentrations used to treat the
cells). Also to get a better overview of the data we compute the mean
spectra of each concentration (there are 4 measurement replicates for
each concentration) and plot them around m/z 760 as we want to use this
signal to normalize and also as lock mass.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>conc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">names</span>(Blank2022spec))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>spec_prc <span class="ot">&lt;-</span> MALDIquant<span class="sc">::</span><span class="fu">removeBaseline</span>(Blank2022spec)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>avg <span class="ot">&lt;-</span> MALDIquant<span class="sc">::</span><span class="fu">averageMassSpectra</span>(spec_prc, <span class="at">labels =</span> conc)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>MALDIquant<span class="sc">::</span><span class="fu">plot</span>(avg[[<span class="dv">1</span>]], <span class="at">main =</span> <span class="st">&quot;Overview of mean spectra&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">755</span>, <span class="dv">765</span>))</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(avg)) {</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  MALDIquant<span class="sc">::</span><span class="fu">lines</span>(avg[[i]], <span class="at">col =</span> i)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>}</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">paste0</span>(<span class="fu">names</span>(avg), <span class="st">&quot;uM&quot;</span>), <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
We see that the alignment of the spectra is quite good but the intensity
varies for the peak around m/z 760. To get best results its necessary to
normalize the spectra to each other. One way is to add a standard to
each measurement spot (internal standard). This is not always possible
and another option is to use endogenous peaks with high abundance like
the signal around 760 m/z. As an example we will now find out the m/z
deviation to this signal for each spectrum. First we need to detect the
peaks, then we convert the peaks to a data.frame and finally we use
getMzShift() to find the mass shift in each spectrum.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>peaks <span class="ot">&lt;-</span> MALDIquant<span class="sc">::</span><span class="fu">detectPeaks</span>(Blank2022spec, <span class="at">method =</span> <span class="st">&quot;SuperSmoother&quot;</span>, <span class="at">SNR =</span> <span class="dv">5</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">names</span>(peaks) <span class="ot">&lt;-</span> <span class="fu">names</span>(Blank2022spec)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>mz_shift <span class="ot">&lt;-</span> <span class="fu">getMzShift</span>(<span class="at">peaks =</span> peaks, <span class="at">targetMz =</span> <span class="fl">760.585</span>, <span class="at">tol =</span> <span class="dv">500</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; found mz 760.585 in 32 / 32 spectra</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; 15:58 mzshift was -0.0796625 in mean and 0.0828  abs. max.</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="fu">summary</span>(mz_shift<span class="sc">$</span>mzshift)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; -0.08280 -0.08280 -0.08280 -0.07966 -0.08280 -0.05770</span></span></code></pre></div>
<p>As we already suspected the shift is quite small. Now lets use it to
align the spectra</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>spec_align <span class="ot">&lt;-</span> <span class="fu">shiftMassAxis</span>(Blank2022spec, mz_shift<span class="sc">$</span>mzshift)</span></code></pre></div>
<p>Now that we have aligned spectra the next step is to normalize them.
Also here, a internal standard would be great but as we dont have one we
again use the m/z 760 endogenous signal. First we extract the
intensities for each spectrum of this signal and then we use it as a
normalization factor.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>peaks_align <span class="ot">&lt;-</span> MALDIquant<span class="sc">::</span><span class="fu">detectPeaks</span>(spec_align, <span class="at">method =</span> <span class="st">&quot;SuperSmoother&quot;</span>, <span class="at">SNR =</span> <span class="dv">3</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>norm <span class="ot">&lt;-</span> <span class="fu">getNormFactors</span>(<span class="at">peaksdf =</span> <span class="fu">peaks2df</span>(peaks_align), <span class="at">targetMz =</span> <span class="fl">760.585</span>, <span class="at">tol =</span> <span class="dv">100</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">summary</span>(norm<span class="sc">$</span>norm_factor)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt;    7949   12842   14492   14099   16145   19570</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>spec_rdy <span class="ot">&lt;-</span> <span class="fu">normalizeByFactor</span>(spec_align, norm<span class="sc">$</span>norm_factor)</span></code></pre></div>
<p>As a final check we now plot again the aligned and normalizes mean
spectra for each concentration.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>avg_rdy <span class="ot">&lt;-</span> MALDIquant<span class="sc">::</span><span class="fu">averageMassSpectra</span>(spec_rdy, <span class="at">labels =</span> conc)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>MALDIquant<span class="sc">::</span><span class="fu">plot</span>(avg_rdy[[<span class="dv">1</span>]], <span class="at">main =</span> <span class="st">&quot;Overview of mean spectra&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">755</span>, <span class="dv">765</span>))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(avg_rdy)) {</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  MALDIquant<span class="sc">::</span><span class="fu">lines</span>(avg_rdy[[i]], <span class="at">col =</span> i)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>}</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">paste0</span>(<span class="fu">names</span>(avg), <span class="st">&quot;uM&quot;</span>), <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="high-variance-filtering" class="section level2">
<h2>High variance filtering</h2>
<p>As expected we find our spectra to be perfectly aligned and
normalized to 760.585. Now we can again detect peaks, bin them and
compose a intensity matrix of all peaks.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>peaks_rdy <span class="ot">&lt;-</span> MALDIquant<span class="sc">::</span><span class="fu">detectPeaks</span>(avg_rdy, <span class="at">method =</span> <span class="st">&quot;SuperSmoother&quot;</span>, <span class="at">SNR =</span> <span class="dv">3</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>peaks_rdy <span class="ot">&lt;-</span> MALDIquant<span class="sc">::</span><span class="fu">binPeaks</span>(peaks_rdy)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>intmat <span class="ot">&lt;-</span> MALDIquant<span class="sc">::</span><span class="fu">intensityMatrix</span>(peaks_rdy, avg_rdy)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="fu">dim</span>(intmat)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; [1]   8 211</span></span></code></pre></div>
<p>We get a intensity matrix with 211 peaks in total. The next step is
to screen for high variant peaks.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">apply</span>(intmat, <span class="dv">2</span>, var)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(vars <span class="sc">&gt;</span> <span class="fu">mean</span>(vars))</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>highVarIntmat <span class="ot">&lt;-</span> intmat[,idx]</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">dim</span>(highVarIntmat)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; [1]  8 20</span></span></code></pre></div>
</div>
<div id="fit-curve" class="section level2">
<h2>Fit Curve</h2>
<p>We end up with 20 candidate peaks for which we want to fit a IC50
curve. Lets do the fitting for one exemplary signal.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>concLog <span class="ot">&lt;-</span> <span class="fu">log10</span>(<span class="fu">unique</span>(conc))</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(concLog <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span>)) {</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>      concLog[<span class="fu">which</span>(concLog <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span>)] <span class="ot">&lt;-</span> (<span class="fu">min</span>(concLog[<span class="fu">which</span>(<span class="sc">!</span>concLog <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span>)])<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    }</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>resp <span class="ot">&lt;-</span> nplr<span class="sc">::</span><span class="fu">convertToProp</span>(<span class="at">y =</span> intmat[,<span class="dv">10</span>])</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>model <span class="ot">&lt;-</span> nplr<span class="sc">::</span><span class="fu">nplr</span>(<span class="at">x =</span> concLog, <span class="at">y =</span> resp, <span class="at">useLog =</span> <span class="cn">FALSE</span>, <span class="at">npars =</span> <span class="dv">4</span>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;m/z =&quot;</span>, <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(intmat)[<span class="dv">12</span>]), <span class="dv">2</span>))</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">main =</span> title)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
And with that we are finished! As said during the introduction we did
each step manually. To do what we did in an automated way for each
signal of interest use the following function:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">fitCurve</span>(<span class="at">spec =</span> Blank2022spec,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>         <span class="at">SinglePointRecal =</span> <span class="cn">TRUE</span>, </span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>         <span class="at">normMz =</span> <span class="fl">760.585</span>, </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>         <span class="at">alignTol =</span> <span class="fl">0.1</span>, </span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>         <span class="at">normTol =</span> <span class="fl">0.1</span>)</span></code></pre></div>
</div>
<div id="session-info" class="section level2">
<h2>Session Info</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">#&gt; R version 4.3.2 (2023-10-31 ucrt)</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64 (64-bit)</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; Running under: Windows 10 x64 (build 19045)</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; Matrix products: default</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; locale:</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt; [1] LC_COLLATE=C                    LC_CTYPE=German_Germany.utf8   </span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt; [3] LC_MONETARY=German_Germany.utf8 LC_NUMERIC=C                   </span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; [5] LC_TIME=German_Germany.utf8    </span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#&gt; time zone: Europe/Berlin</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co">#&gt; tzcode source: internal</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt; attached base packages:</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">#&gt; other attached packages:</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="co">#&gt; [1] MALDIquant_1.22.1     MALDIcellassay_0.4.47</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="co">#&gt;  [1] gtable_0.3.4             jsonlite_1.8.7           highr_0.10              </span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="co">#&gt;  [4] dplyr_1.1.4              compiler_4.3.2           tidyselect_1.2.0        </span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="co">#&gt;  [7] parallel_4.3.2           tidyr_1.3.0              jquerylib_0.1.4         </span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co">#&gt; [10] scales_1.3.0             yaml_2.3.7               fastmap_1.1.1           </span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co">#&gt; [13] ggplot2_3.5.0            R6_2.5.1                 generics_0.1.3          </span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co">#&gt; [16] knitr_1.45               forcats_1.0.0            XML_3.99-0.15           </span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="co">#&gt; [19] tibble_3.2.1             nplr_0.1-7               munsell_0.5.0           </span></span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="co">#&gt; [22] readBrukerFlexData_1.9.1 bslib_0.6.0              pillar_1.9.0            </span></span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a><span class="co">#&gt; [25] rlang_1.1.2              utf8_1.2.4               cachem_1.0.8            </span></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="co">#&gt; [28] xfun_0.41                sass_0.4.7               cli_3.6.1               </span></span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a><span class="co">#&gt; [31] withr_2.5.2              magrittr_2.0.3           digest_0.6.33           </span></span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a><span class="co">#&gt; [34] grid_4.3.2               rstudioapi_0.15.0        base64enc_0.1-3         </span></span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a><span class="co">#&gt; [37] lifecycle_1.0.4          vctrs_0.6.4              readMzXmlData_2.8.3     </span></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a><span class="co">#&gt; [40] evaluate_0.23            glue_1.6.2               MALDIquantForeign_0.14  </span></span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a><span class="co">#&gt; [43] svMisc_1.2.3             colorspace_2.1-0         fansi_1.0.5             </span></span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a><span class="co">#&gt; [46] purrr_1.0.2              rmarkdown_2.25           tools_4.3.2             </span></span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a><span class="co">#&gt; [49] pkgconfig_2.0.3          htmltools_0.5.7</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
